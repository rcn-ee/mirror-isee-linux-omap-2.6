/*
 * Device Tree Source for IGEP EXPANSION BASE0010RB with
 * COM MODULE Rev. E (TI OMAP AM/DM37x)
 *
 * Copyright (C) 2015 ISEE <isee.biz>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#include "omap3-igep0030.dts"
#include "omap-gpmc-smsc9221.dtsi"

/ {
	model = "IGEP EXP BASE0010RB with COM MODULE Rev. E (TI OMAP AM/DM37x)";
	compatible = "isee,omap3-igep0030-base0010", "isee,omap3-igep0030", "ti,omap36xx", "ti,omap3";

	reg_lcd_3V3: lcd_3V3 {
		compatible = "regulator-fixed";
		regulator-name = "lcd_3V3";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		gpio = <&gpio6 26 0>;    /*SYS_CLKOUT2.gpio_186*/
		startup-delay-us = <70000>;
		regulator-boot-on;
	};
};

&omap3_pmx_wkup {
	pinctrl-names = "default";

   tsc2048_pins: pinmux_tsc2048_pins {
		pinctrl-single,pins = <
			OMAP3_WKUP_IOPAD(0x2a1a, PIN_INPUT | MUX_MODE4)   /* sys_clkout1.gpio_10 */
		>;
	};
};

&omap3_pmx_core {
   smsc9221_ETH1_pins: pinmux_smsc9221_ETH1_pins {
		pinctrl-single,pins = <
			0x08a (PIN_OUTPUT | MUX_MODE0)		/* gpmc_ncs6.gpmc_ncs6 */
			0x058 (PIN_INPUT | MUX_MODE4)	      /* gpmc_a8.gpio_41 */
		>;
	};

   smsc9221_ETH2_pins: pinmux_smsc9221_ETH2_pins {
		pinctrl-single,pins = <
			0x086 (PIN_OUTPUT | MUX_MODE0)		/* gpmc_ncs4.gpmc_ncs4 */
			0x080 (PIN_INPUT | MUX_MODE4)		   /* gpmc_ncs1.gpio_52 */
		>;
	};

	spi1_pins: pinmux_spi1_pins {
		pinctrl-single,pins = <
			OMAP3_CORE1_IOPAD(0x21c8, PIN_INPUT_PULLDOWN | MUX_MODE0)   /* mcspi1_clk.mcspi1_clk */
			OMAP3_CORE1_IOPAD(0x21ca, PIN_INPUT_PULLDOWN | MUX_MODE0)   /* mcspi1_simo.mcspi1_simo */
			OMAP3_CORE1_IOPAD(0x21cc, PIN_INPUT_PULLDOWN | MUX_MODE0)   /* mcspi1_somi.mcspi1_somi */
			OMAP3_CORE1_IOPAD(0x21d0, PIN_OUTPUT | MUX_MODE0)   /* mcspi1_cs1.mcspi1_cs1 */
         OMAP3_CORE1_IOPAD(0x2138, PIN_INPUT | MUX_MODE4)   /* gpio_114.gpio_114 */
		>;
   };
};

&gpmc {
	ranges = <0 0 0x00000000 0x20000000>,
         <6 0 0x2d000000 0x01000000>,
		   <4 0 0x2b000000 0x01000000>;

   ethernet@gpmc {
      pinctrl-names = "default";
		pinctrl-0 = <&smsc9221_ETH1_pins>;
      reg = <6 0 0xff>;
		interrupt-parent = <&gpio2>;
      interrupts = <9 IRQ_TYPE_LEVEL_LOW>;
	};

   ethernet2@gpmc {
		pinctrl-names = "default";
		pinctrl-0 = <&smsc9221_ETH2_pins>;
      reg = <4 0 0xff>;
		interrupt-parent = <&gpio2>;
      interrupts = <20 IRQ_TYPE_LEVEL_LOW>;
	};
};

&mcspi1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&spi1_pins>;

	tsc2046@0 {
		reg = <1>;   /* CS1 */
		compatible = "ti,tsc2046";
		interrupt-parent = <&gpio1>;
		interrupts = <10 0>;   /* sys_clkout1.gpio_10 */
		spi-max-frequency = <1000000>;
		pendown-gpio = <&gpio1 10 0>;  /* sys_clkout1.gpio_10 */
		vcc-supply = <&reg_lcd_3V3>;
		pinctrl-names = "default";
		pinctrl-0 = <&tsc2048_pins>;
		ti,x-min = <138>;
		ti,x-max = <3923>;
		ti,y-min = <311>;
		ti,y-max = <3962>;
		ti,x-plate-ohms = <180>;
		ti,pressure-max = <255>;
      ti,debounce-max = <10>;
      ti,debounce-tol = <3>;
      ti,debounce-rep = <1>;
		linux,wakeup;
	};
};
